---
layout: post
title:  "I build a Discord bot using Python!"
description: I took up a small project over the weekend, to build a discord bot that I could add to my discord guild dedicated to gaming!
date:   2020-07-28
categories: One Day Builds
comments: false
---
<p> I took up a weekend project and built my own Discord bot with python. With the on-going pandemic, and limited outside access, I have come back to being an avid gamer. With multiplayer FPS games, communication is the key for ensuring victory. For reliable comms, my friends and I use Discord. For those of you who dont know, Discord is an instant messaging and VoIP application that enables users to create guilds(commonly known as servers) and allows us to have multiple voice channels in them as well. This makes it very convenient to stay in contact, and making sure that I carry our team to victory. 
</p>
<p>Discord has a feature that allows users to add <b>Bots</b> to the guild. A Bot is basically a computer program that is built to perform actions assigned to them by its developer. These Bots are invoked by a pre-assigned command, followed by arguments. For example, the Rhythm Bot allows a user to play songs in the voice channel that he is currently in. There are a plethora of Bots that you can find online that do just about everything you command it to. Infact, when I was searching for the right Bot for me, I was faced with the problem of too many choices. Instead, I chose to build my own Bot.</p>

<h3><b>About my Discord Bot. </b></h3>
<p> One of the most common things that you'd get to read about my guild's conversations is that we deerank a lot in our games. The opponent team always has someone who's cheating (we're just really bad). Keeping with this trend, I named my bot as <b>DeeRank</b>.</p>
<p>The next thing I had to focus on is what DeeRank would be able to do for you(the user). After some thinking, googling and asking around, I came up with a short list of things that DeeRank would be programmed to do. <br>Here's a list of the Bot's functionalities:
<ol>
    <li>Commands only for Admin</li>
        <ul>
            <li>Kick</li>
            <li>Ban</li>
            <li>leave</li>
        </ul>
    <li>Commands for Everyone</li>
    <ul>
        <li>8ball</li>
        <li>dad_joke</li>
        <li>df</li>
        <li>memez</li>
    </ul>
</ol>
<br>To speak to DeeRank, you'd have to precede the command with <b>></b> symbol.<br>
DeeRank has got quite a potty mouth and wouldn't handle mistakes very well. Just keep that in mind if you plan on adding it to your guild. </p>

<h3><b>A Close Look At The Bot's Code </b></h3>
<ul>
    <li>
        <h4><b>Start Point</b></h4>
        <script src="https://gist.github.com/agk98/7ff299cb72ec710906da4ec7a135a998.js"></script>
        <p>
            Discord has made it very simple to interact with their API by publishing the discord.py package. The discord.py package is a python wrapper for Discord's API. To write all the commands that can be issues to the Bot, discord.py provides extensions. This is imported from <b>discord.ext</b>.
        </p>
        <p>
            The first step is to create an instance of the discord bot. Over here, my Bot is named as <b>deerank</b> and this serves as the client which interacts with the discord API. The <b>commands_prefix</b> parameter if to specify what the prefix is to be used when the Bot is invoked by a user. This was, the Bot knows that the user is commanding it to perform a task.
        </p>
        <p>
            A very useful feature of discord.py is that it enable the usage of <b>Cogs</b>. Each cog is a Python class that subclasses <b>commands.Cog</b> and allows me to organise a collection of commands, listeners, and some state into one class. Cogs are thus classes which need to be loaded to be used and unloaded to be removed from the Bot's functionality. The <b>load</b> and <b>unload</b> function enables this functionality. 
        </p>
        <p>
            To run the program, the Bot needs to get authorisation from discord, to be able to interact with the API. For this, it has to connect to the discord server's using it's own Client secret ID. The client secret ID, I stored in another file, to keep it hidden. The file reading code is to read the file and retrieve the Client Secret ID before it runs the program.
        </p>
    </li>
    <li>
        <h4><b>Commands For The Admin</b></h4>
        <script src="https://gist.github.com/agk98/8bd3134f170ff77f4fd94cadfc3426d6.js"></script>
        <p>
            There are some commands which I have added and are to be used only by the Admin of the guild. This avoids unnecessary conflicts and abuse of Administrator powers of the bots. When issuing commands to the Bot, command handlers as functions are programmed into the Bot's code. <b>@commands.command()</b> of the commands extension from discord.py provides support for this.<br/>
            The Bot is able to read the commands issued to it due to the context of the message being fed to it as a parameter of the command. This parameter is <b>ctx</b> and the Bot sends messages to the server and that channel with the help of <b>ctx.send()</b>. Through ctx, the Bot is able to extract valurable information such as, the user who issued the command, the guild that the user belongs to, the userID, etc..
        </p>
        <ol>
            <li>
                <b>>kick</b>
                <p>Parameters: <b>{member: Required} </b></p>
                <p>
                    This command allows for the Admin to kick a member out of the guild. When a user first issues this command, the bot first authenticates to check whether the issuer is the admin of the guild, or no. If not, the Bot replies with a message asking the user to contact the admin to issue the command. The bot verifies this by checking whether the issuer's ID and the guild's ID is the same or no. On the other hand, if the admin is the one who issued to command, then the Bot immediately kicks the member out of the guild and follows with a cheeky message saying that the player has been DeeRanked. 
                    In case the Bot encounters any errors while carrying out this command, it invokes the <b>kick_error()</b> error handler. This error handler is responsible for checking whether it is a known or unknown error. The two known probable errors are: <b>commands.BadArgument</b> and <b>commands.MissingRequiredArgument</b>. The <b>commands.BadArgument</b> is matched when the command parameter doesn't contain the name of a person in the guild. The <b>commands.MissingRequiredArgument</b> is matched when the issuer forgets to include the name of the member they wish to kick from the guild.
                </p>
            </li>
            <li>
                <b>>ban</b><br/>
                <p>Parameters: <b>{member: Required}</b></p>
                <p>
                    This command invokes the Bot to ban a member from the guild, disallowing them to join the guild again. The functionality and the code of this command is almost entirely the same as that of <b>>kick</b> command. The only difference is that, the Bot executes the <b>member.ban()</b> command instead of the <b>member.kick</b> command. 
                </p>
            </li>
            <li>
                <b>>leave</b><br/>
                <p>
                    When this command is issued by the admin of the guild, it forces the bot to go offline, making it unavailable to accept commands from users.
                </p>
            </li>
        </ol>
    </li>
    <li>
        <h4><b>Commands For Everyone</b></h4>

    </li>
</ul>

